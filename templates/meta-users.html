{{define "title"}}meta - Users{{end}}
{{define "content"}}
<main class="container meta">
    <div class="repo__menu">
        <a href="/meta" class="repo__menu__item">general</a>
        <a href="/meta/keys" class="repo__menu__item">keys</a>
        <a href="" class="repo__menu__item repo__menu__item--active">users</a>
    </div>
    <div class="meta__detail">
        {{if .IsAdmin}}
        <form class="form meta__detail__form" method="POST" action="/meta/users">
            <div class="form__title">add new user</div>
            <div class="meta__detail__form__error">{{ .RegisterErrMessage }}</div>
            <div class="meta__error"></div>
            <div class="form__group">
                <label for="newUsername">Username<i>*</i></label>
                <input type="text" class="form__input" id="newUsername" name="username" value="" autocomplete="off" spellcheck="false"/>
            </div>
            <div class="form__group">
                <label for="newPassword">Password<i>*</i></label>
                <input type="password" class="form__input" id="newPassword" name="password" value="" autocomplete="off" spellcheck="false" />
            </div>
            <div class="form__group checkbox__group">
                <input type="checkbox" id="canCreateRepo" name="createrepo" value="yes" />
                <label for="canCreateRepo">Access to create repository</label>
            </div>
            <input type="submit" class="button button--primary" value="Save" />
        </form>
        {{end}}
        <div class="meta__users">
            <div class="meta__users__title">users</div>
            {{if .IsAdmin}}
                {{range .Users.Users}}
                <div class="meta__users__item">
                    <div>Username {{if .IsAdmin}} [Admin] {{end}}</div>
                    <p>{{.Username}}</p>
                    {{if .CanCreateRepo}}
                        <p class="create-repo-access">This user can create repositories.</p>
                    {{end}}
                    {{if not .IsAdmin}}
                    <div class="meta__users__item__buttons">
                        {{if .CanCreateRepo}}
                        <a href="" class="button button--danger">Revoke access</a>
                        {{end}}
                        <a href="" class="button button--danger">Delete user</a>
                    </div>
                    {{end}}
                </div>
                {{end}}
            {{else}}
            {{range .Users.Users}}
                <div class="meta__users__item">
                    <div>Username {{if .IsAdmin}} [Admin] {{end}}</div>
                    <p>{{.Username}}</p>
                    {{if .CanCreateRepo}}
                        <p class="create-repo-access">This user can create repositories.</p>
                    {{end}}
                </div>
                {{end}}
            {{end}}
        </div>
    </div>
</main>
{{end}}